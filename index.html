<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Elvenor ✨ Thank You</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Allura&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poiret+One&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Sacramento&display=swap" rel="stylesheet">

<style>
@font-face {
  font-family: 'Didot';
  src: url('Didot.woff2') format('truetype');
  font-weight: normal;
  font-style: normal;
}

body {
  margin: 0;
  height: 100vh;
  width: 100%;
  overflow: hidden;
  font-family: 'Georgia', serif;
  transition: background 1s ease;
}

/* NEW WRAPPER TO MOVE ENTIRE PAGE DOWN */
.page-wrapper {
  position: relative;
  top: 120px; /* Adjust this value to move everything down */
  width: 100%;
  height: 100%;
}

.main-content {
  position: relative;
  z-index: 10; /* above sparkles */
}

.logo-underline {
  position: absolute;
  top: 12px;
  left: 53%;
  transform: translateX(-50%);
  width: 250px;
  pointer-events: none;
  z-index: 2; /* below flowers */
}

.flower-wrap {
  position: absolute;
  pointer-events: none;
  transform-origin: center;
  z-index: 6;
  overflow: visible; /* important */
}
.flower {
  width: 80px;
  height: 80px;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  transform-origin: center;
  image-rendering: auto;
  backface-visibility: hidden;
  transform-style: preserve-3d;
}

/* Size presets */
.size-small  { transform: scale(0.9); }
.size-medium { transform: scale(1); }
.size-large  { transform: scale(1.15); }

.underline-text {
  display: inline-block;
  position: relative;
  padding-bottom: 6px;
}

.underline-text::before,
.underline-text::after {
  content: "";
  position: absolute;
  left: 0;
  width: 100%;
  height: 1.2px;
  background: linear-gradient(
    120deg,
    rgba(212,175,55,0.25),
    rgba(255,235,180,0.95),
    rgba(212,175,55,0.25)
  );
  background-size: 200% 100%;
  transform-origin: left;
  filter: blur(0.3px);
  animation: underlineBreath 4.8s ease-in-out infinite;
}

.underline-text::before { bottom: 0; }
.underline-text::after { bottom: -4px; opacity: 0.5; animation-delay: 2.4s; }

@keyframes underlineBreath {
  0% { background-position: 0% 50%; opacity: 0.35; }
  50% { background-position: 100% 50%; opacity: 1; }
  100% { background-position: 0% 50%; opacity: 0.35; }
}

.container {
  position: absolute;
  top: 20%;
  left: 50%;
  transform: translateX(-50%);
  text-align: left;
  color: #fff;
  opacity: 0;
  transition: opacity 4s ease;
  width: 90%;
  max-width: 500px;
}

.logo {
  font-family: 'Allura', cursive;
  font-size: 54px;
  text-align: center;
  color: #F3E5AB;
  margin-top: 18px;
  position: relative;
  z-index: 3; /* logo above underline, below flowers */
}

.thankyou {
  text-align: left;
  margin-top: 80px;
  font-size: 18px; 
  color: #FFF8E7;
  letter-spacing: 0.5px;
  transform: scaleX(1.05);
  margin-left: 5px;
}

.cta-line {
  font-family: 'Poiret One', sans-serif;
  font-size: 12px;
  color: #fff;
  text-shadow: 0 0 1.5px gold;
  text-align: center;
  margin-right: 0px;
  white-space: nowrap;
}

.insta-wrap {
  display: flex;
  flex-direction: column;
  margin-top: 50px;
  align-items: center;  /* change from flex-end to center */
}

.insta-btn {
  display: inline-block;
  padding: 0;
  border: none;
  background: transparent;
  color: #fff;
  text-decoration: none;
  font-weight: bold;
  font-size: 12px;
  margin-top: 60px;
  font-family: 'Poiret One', sans-serif;
  text-shadow: 0 0 1.5px gold;
  position: relative;
  white-space: nowrap;
}

.sparkle {
  position: absolute;
  font-size: 2px;
  color: #f6d27a;
  pointer-events: none;
  text-shadow: 0 0 3.5px gold;
  user-select: none;
  opacity: 0;
  z-index: 1; /* behind everything */
}

html, body {
  overflow: hidden !important;
  overscroll-behavior: none;
  touch-action: none;
}

/* NAME PROMPT STYLES */
.name-prompt-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
  background: transparent;
}

.name-prompt-box {
  background: transparent;
  padding: 0;
  border: none;
  text-align: center;
  z-index: 1001;
  max-width: 400px;
  width: 90%;
}

.name-prompt-text {
  font-family: 'Poiret One', sans-serif;
  font-size: 18px;
  color: #F3E5AB;
  margin-bottom: 20px;
  text-shadow: 0 0 3px rgba(243, 229, 171, 0.5);
}

.name-input-wrapper {
  position: relative;
  margin: 0 auto;
  width: 300px;
}

.name-input-line {
  width: 100%;
  height: 1px;
  background: linear-gradient(90deg, 
    transparent 0%, 
    rgba(212,175,55,0.7) 20%, 
    rgba(255,235,180,0.95) 50%, 
    rgba(212,175,55,0.7) 80%, 
    transparent 100%
  );
  margin-bottom: 5px;
}

.name-input {
  width: 100%;
  background: transparent;
  border: none;
  color: #FFF8E7;
  font-family: 'Sacramento', cursive;
  font-size: 28px;
  text-align: center;
  outline: none;
  padding: 5px 0;
  caret-color: #F3E5AB;
  letter-spacing: 1px;
}

.name-input::placeholder {
  color: rgba(255, 248, 231, 0.3);
  font-family: 'Sacramento', cursive;
  font-size: 24px;
}

.name-submit {
  background: transparent;
  border: none;
  color: #F3E5AB;
  font-family: 'Poiret One', sans-serif;
  font-size: 12px;
  margin-top: 15px;
  cursor: pointer;
  opacity: 0.7;
  transition: opacity 0.3s ease;
  text-shadow: 0 0 2px gold;
}

.name-submit:hover {
  opacity: 1;
}

/* WELCOME NOTE STYLES */
.welcome-note-container {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 501;
  opacity: 0;
  pointer-events: none;
  text-align: center;
  transition: opacity 1.5s ease;
  min-width: 200px;
  max-width: 350px;
}

.welcome-note {
  font-family: 'Poiret One', sans-serif;
  font-size: 16px;
  color: #F3E5AB;
  text-shadow: 0 0 10px rgba(243, 229, 171, 0.7);
  white-space: nowrap;
  margin-bottom: 15px;
  position: relative;
  display: inline-block;
  padding: 0 10px;
}

/* REALISTIC COMET UNDERLINE */
.comet-trail {
  position: absolute;
  bottom: -12px;
  left: 50%;
  transform: translateX(-50%);
  width: calc(100% - 20px); /* Match welcome note width */
  height: 3px;
  overflow: visible;
}

.comet-particle {
  position: absolute;
  font-family: 'Arial', sans-serif;
  color: #F3E5AB;
  text-shadow: 
    0 0 0.5px rgba(255, 235, 180, 0.9),
    0 0 1px rgba(255, 235, 180, 0.6);
  pointer-events: none;
  user-select: none;
  opacity: 0;
  transform-origin: center;
  will-change: transform, opacity;
}

/* Comet head (right side - where comet is heading) */
.comet-head {
  position: absolute;
  right: -6px;
  top: 50%;
  transform: translateY(-50%);
  width: 12px;
  height: 12px;
  background: radial-gradient(
    circle at center,
    rgba(243, 229, 171, 0.4) 0%,
    rgba(243, 229, 171, 0.2) 40%,
    rgba(243, 229, 171, 0.05) 70%,
    transparent 90%
  );
  filter: blur(1px);
  border-radius: 50%;
  z-index: -1;
  animation: headPulse 2.5s ease-in-out infinite;
}

/* Comet tail glow (left side - where comet came from) */
.comet-tail-glow {
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  width: 40px;
  height: 2px;
  background: linear-gradient(
    90deg,
    rgba(243, 229, 171, 0.15) 0%,
    rgba(243, 229, 171, 0.05) 50%,
    transparent 100%
  );
  filter: blur(0.5px);
  z-index: -1;
}

@keyframes headPulse {
  0%, 100% { 
    opacity: 0.4;
    transform: translateY(-50%) scale(0.9);
  }
  50% { 
    opacity: 0.7;
    transform: translateY(-50%) scale(1.1);
  }
}

/* Comet moving animation (left to right) */
@keyframes cometMove {
  0% {
    opacity: 0;
    transform: translateX(-5px) scale(0.7);
  }
  10% {
    opacity: 0.3;
    transform: translateX(0) scale(0.9);
  }
  20% {
    opacity: 0.7;
    transform: translateX(5px) scale(1.1);
  }
  30% {
    opacity: 0.4;
    transform: translateX(10px) scale(1);
  }
  40% {
    opacity: 0.2;
    transform: translateX(15px) scale(0.8);
  }
  50% {
    opacity: 0.1;
    transform: translateX(20px) scale(0.7);
  }
  60% {
    opacity: 0.05;
    transform: translateX(25px) scale(0.6);
  }
  70% {
    opacity: 0;
    transform: translateX(30px) scale(0.5);
  }
  100% {
    opacity: 0;
    transform: translateX(100px) scale(0.3);
  }
}
</style>
</head>

<body>

<!-- NAME PROMPT OVERLAY -->
<div class="name-prompt-container" id="namePrompt">
  <div class="name-prompt-box">
    <div class="name-prompt-text">To whom does this sparkle belong?</div>
    <div class="name-input-wrapper">
      <div class="name-input-line"></div>
      <input type="text" class="name-input" id="customerName" placeholder="your beautiful name" maxlength="30">
    </div>
    <button class="name-submit" id="submitName">Enter your sparkle ✨</button>
  </div>
</div>

<!-- WELCOME NOTE (will be shown during halo transition) -->
<div class="welcome-note-container" id="welcomeNoteContainer">
  <div class="welcome-note" id="welcomeNote"></div>
  <div class="comet-trail" id="cometTrail">
    <!-- Comet head (right side) -->
    <div class="comet-head"></div>
    <!-- Comet tail glow (left side) -->
    <div class="comet-tail-glow"></div>
    <!-- Particles will be generated by JavaScript -->
  </div>
</div>

<!-- WRAP EVERYTHING IN THIS DIV -->
<div class="page-wrapper" style="display: none;" id="mainContent">
  <div class="main-content">
    <div class="container">
      <div class="logo">Elvenor</div>
      <img src="underline.png" class="logo-underline" alt="Logo Underline">

      <div class="flowers">

  <div class="flower-wrap size-medium" style="top:34px; left:53.5px;">
    <div class="flower"></div>
  </div>
  <div class="flower-wrap size-large" style="top:45.5px; left:145px;">
    <div class="flower"></div>
  </div>
  <div class="flower-wrap size-small" style="top:34.3px; left:177.5px;">
    <div class="flower"></div>
  </div>
  <div class="flower-wrap size-medium" style="top:32px; left:205.18px;">
    <div class="flower"></div>
  </div>
  
</div>

      <div class="thankyou" id="thankyou-note"></div>
      <div class="insta-wrap">
        <div class="cta-line">
          Your thoughts inspire us — we'd love to hear from you.
        </div>
        <a class="insta-btn" href="https://instagram.com/elvenor.store" target="_blank">
          <span class="underline-text">Share your sparkle ✨</span>
        </a>
      </div>
    </div>
  </div>
</div>

<audio id="chime" src="shine.mp3" preload="auto"></audio>

<script>
// AUTO-PLAY CHIME ON PAGE LOAD
window.addEventListener('load', function() {
  const AudioContext = window.AudioContext || window.webkitAudioContext;
  if (AudioContext) {
    const audioContext = new AudioContext();
    
    const resumeAudio = () => {
      if (audioContext.state === 'suspended') {
        audioContext.resume();
      }
    };
    
    document.addEventListener('click', resumeAudio, { once: true });
    document.addEventListener('touchstart', resumeAudio, { once: true });
    document.addEventListener('keydown', resumeAudio, { once: true });
  }
});

// BACKGROUND COLORS - UNCHANGED
const colors = [     
/* =======================
     WINE / PLUM / OXBLOOD
     ======================= */
  "#36001e", // Dark Mulberry
  "#1E0011", // Black Cherry Wine
  "#1c0621", // Plum Noir
  "#4d062c", // Crimson Wine

  /* =======================
     NAVY / MIDNIGHT BLUE
     ======================= */
  "#030A1C", // Midnight Ink
  "#00001c", // Absolute Navy
  "#080b38", // Deep Indigo Night
  "#16174d", // Royal Midnight Blue

  /* =======================
     TEAL / BLUE-GREEN
     ======================= */
  "#1a4a4f", // Deep Teal Ocean
  "#1E3130", // Dark Petrol Teal
  "#163832", // Forest Teal
  "#051f20", // Blackened Teal
  "#001e1e", // Abyss Teal
  "#002426", // Deep Sea Green
  "#001e17", // Emerald Shadow
  "#021e13", // Dark Moss Green
  "#091712", // Pine Night

  /* =======================
     BLUE-GREY / SLATE
     ======================= */
  "#002438", // Deep Slate Blue
  "#1a2f3b", // Storm Blue Grey

  /* =======================
     NEAR-BLACK / CHARCOAL
     ======================= */
  "#0c0807", // Charcoal Cocoa
  "#000e01"  // Black Forest
  
];
document.body.style.background = colors[Math.floor(Math.random()*colors.length)];

// COMET PARTICLES - ONLY ✦ AND ✧
const cometChars = ['✦', '✧'];

// WELCOME NOTES
const welcomeNotes = [
  "We see your light, [Name].",
  "Your essence is known, [Name].",
  "The magic recognizes you, [Name]."
];

// THANK YOU NOTES - UNCHANGED
const thankYouNotes = [
  {text: "With gratitude, Elvenor thanks you for letting us add a sparkle to your day.", font: "'Sacramento', sans-serif"},
  {text: "Thank you for shopping with Elvenor — Every piece is made to celebrate your brilliance.", font: "'Sacramento', sans-serif"},
  {text: "We are grateful for your choice — Elvenor celebrates the sparkle you bring.", font: "'Poiret One', sans-serif"},
  {text: "Your elegance inspires us — Thank you for shopping with Elvenor.", font: "'Didot', sans-serif"},
  {text: "Every shimmer matters. Elvenor thanks you for letting us be part of yours.", font: "'Sacramento', sans-serif"},
  {text: "Your sparkle lights up our world — Thank you for choosing Elvenor.", font: "'Poiret One', sans-serif"},
  {text: "With warmth and gratitude, Elvenor celebrates your choice today.", font: "'Didot', sans-serif"}
];

// VARIABLES
let namePromptHaloElements = [];
let namePromptAnimationId = null;
let customerName = "";
let selectedThankYouNote = null;
let selectedWelcomeNote = null;

// CREATE REALISTIC COMET (LEFT TO RIGHT MOVEMENT)
function createRealisticComet() {
  const cometTrail = document.getElementById('cometTrail');
  const welcomeNote = document.getElementById('welcomeNote');
  
  // Get the width of the welcome note for proper sizing
  const welcomeWidth = welcomeNote.offsetWidth;
  cometTrail.style.width = `${welcomeWidth}px`;
  
  // Clear any existing particles (keep head and tail glow)
  const particles = cometTrail.querySelectorAll('.comet-particle');
  particles.forEach(p => p.remove());
  
  const trailWidth = welcomeWidth;
  const particleCount = 120; // Reduced for shorter trail
  
  // Create particles with proper left-to-right density gradient
  for (let i = 0; i < particleCount; i++) {
    const particle = document.createElement('span');
    particle.className = 'comet-particle';
    
    // Character selection
    const char = cometChars[Math.floor(Math.random() * cometChars.length)];
    
    // SMALLER SIZES as requested: 0.5px, 1px, 1.5px, 2.5px
    const sizeOptions = [0.5, 1, 1.5, 2.5];
    const fontSize = sizeOptions[Math.floor(Math.random() * sizeOptions.length)];
    
    // Position: Dense on left (where comet came from), sparse on right (where it's going)
    // Using exponential distribution for natural density falloff
    const position = Math.pow(Math.random(), 2); // Square for faster falloff
    const xPosition = trailWidth * (1 - position); // Left (dense) to right (sparse)
    
    // Opacity gradient: Brighter near left (trail), fainter toward right
    let baseOpacity;
    if (position < 0.3) { // Left 30% (trail)
      baseOpacity = 0.4 + Math.random() * 0.3; // 0.4-0.7
    } else if (position < 0.7) { // Middle
      baseOpacity = 0.2 + Math.random() * 0.2; // 0.2-0.4
    } else { // Right 30% (head area)
      baseOpacity = 0.05 + Math.random() * 0.15; // 0.05-0.2
    }
    
    // Vertical position (very slight variation for natural look)
    const yPosition = (Math.random() - 0.5) * 2; // Only ±1px from center
    
    // Apply styles
    particle.style.left = `${xPosition}px`;
    particle.style.top = `calc(50% + ${yPosition}px)`;
    particle.style.fontSize = `${fontSize}px`;
    particle.style.opacity = baseOpacity;
    particle.innerText = char;
    
    // LEFT TO RIGHT MOVEMENT ANIMATION
    // Particles appear from left and move to right
    const animationDuration = 1.5 + Math.random() * 1; // 1.5-2.5 seconds
    const startDelay = (xPosition / trailWidth) * 2; // Stagger based on position
    
    particle.style.animation = `cometMove ${animationDuration}s ease-out ${startDelay}s infinite`;
    
    cometTrail.appendChild(particle);
  }
}

// CREATE SLOW HALO FOR NAME PROMPT
function createNamePromptHalo() {
  const container = document.querySelector('.name-prompt-box');
  const rect = container.getBoundingClientRect();
  const centerX = rect.left + rect.width / 2;
  const centerY = rect.top + rect.height / 2;
  const haloRadius = 150;
  const haloCount = 20;
  
  // Clear any existing halo elements
  namePromptHaloElements.forEach(el => el.remove());
  namePromptHaloElements = [];
  
  // Create new halo elements
  for(let i = 0; i < haloCount; i++) {
    const s = document.createElement('div');
    s.className = 'sparkle';
    s.innerText = cometChars[Math.floor(Math.random() * cometChars.length)];
    s.style.fontSize = (4 + Math.random() * 6) + 'px';
    s.style.opacity = '0.6';
    s.style.zIndex = '999';
    document.body.appendChild(s);
    namePromptHaloElements.push(s);
  }
  
  let startTime = null;
  let angleOffset = 0;
  
  function animateNameHalo(timestamp) {
    if (!startTime) startTime = timestamp;
    const elapsed = timestamp - startTime;
    
    // Very slow rotation while waiting for name input
    angleOffset = (elapsed / 15000) * Math.PI;
    
    namePromptHaloElements.forEach((s, i) => {
      const angle = (i / haloCount) * 2 * Math.PI + angleOffset;
      s.style.left = (centerX + haloRadius * Math.cos(angle) * 1.2) + 'px';
      s.style.top = (centerY + haloRadius * Math.sin(angle) * 0.8) + 'px';
      s.style.opacity = 0.6 + 0.2 * Math.sin(angle * 5 + elapsed / 500);
    });
    
    namePromptAnimationId = requestAnimationFrame(animateNameHalo);
  }
  
  namePromptAnimationId = requestAnimationFrame(animateNameHalo);
}

// DISPLAY WELCOME NOTE
function displayWelcomeNote() {
  const welcomeNoteElement = document.getElementById('welcomeNote');
  const welcomeContainer = document.getElementById('welcomeNoteContainer');
  let welcomeText = selectedWelcomeNote;
  
  // Insert customer name into welcome note
  if (customerName) {
    welcomeText = welcomeText.replace("[Name]", customerName);
  } else {
    welcomeText = welcomeText.replace("[Name]", "Beautiful");
  }
  
  welcomeNoteElement.innerText = welcomeText;
  
  // Create realistic comet (with proper sizing)
  setTimeout(() => {
    createRealisticComet();
  }, 100);
  
  // Show welcome note with fade in
  setTimeout(() => {
    welcomeContainer.style.opacity = '1';
  }, 100);
}

// DISPLAY THANK YOU NOTE WITH CUSTOMER NAME
function displayThankYouNoteWithName() {
  const noteContainer = document.getElementById('thankyou-note');
  let noteText = selectedThankYouNote.text;
  
  // Insert customer name into the thank you note
  if (customerName) {
    if (selectedThankYouNote.text.includes("With gratitude")) {
      noteText = `With gratitude, Elvenor thanks you, ${customerName}, for letting us add a sparkle to your day.`;
    } else if (selectedThankYouNote.text.includes("Thank you for shopping")) {
      noteText = `Thank you for shopping with Elvenor, ${customerName} — Every piece is made to celebrate your brilliance.`;
    } else if (selectedThankYouNote.text.includes("We are grateful")) {
      noteText = `We are grateful for your choice, ${customerName} — Elvenor celebrates the sparkle you bring.`;
    } else if (selectedThankYouNote.text.includes("Your elegance")) {
      noteText = `Your elegance inspires us, ${customerName} — Thank you for shopping with Elvenor.`;
    } else if (selectedThankYouNote.text.includes("Every shimmer matters")) {
      noteText = `Every shimmer matters. Elvenor thanks you, ${customerName}, for letting us be part of yours.`;
    } else if (selectedThankYouNote.text.includes("Your sparkle lights")) {
      noteText = `Your sparkle lights up our world, ${customerName} — Thank you for choosing Elvenor.`;
    } else if (selectedThankYouNote.text.includes("With warmth and gratitude")) {
      noteText = `With warmth and gratitude, Elvenor celebrates your choice today, ${customerName}.`;
    }
  }
  
  noteContainer.innerText = noteText;
  noteContainer.style.fontFamily = selectedThankYouNote.font;
}

// PLAY CHIME SOUND AUTOMATICALLY
function playChimeSound() {
  const haloSound = document.getElementById("chime");
  haloSound.volume = 0.5;
  haloSound.currentTime = 0;
  
  const playPromise = haloSound.play();
  
  if (playPromise !== undefined) {
    playPromise.catch(error => {
      console.log("Autoplay prevented, will play after user interaction");
      
      const playOnInteraction = () => {
        haloSound.play();
        document.removeEventListener('click', playOnInteraction);
        document.removeEventListener('touchstart', playOnInteraction);
      };
      
      document.addEventListener('click', playOnInteraction, { once: true });
      document.addEventListener('touchstart', playOnInteraction, { once: true });
    });
  }
}

// TRANSITION FROM NAME PROMPT TO MAIN CONTENT
function transitionToMainContent() {
  // Stop the slow halo animation
  if (namePromptAnimationId) {
    cancelAnimationFrame(namePromptAnimationId);
  }
  
  // Remove name prompt halo elements
  namePromptHaloElements.forEach(el => {
    el.style.transition = 'opacity 1s ease';
    el.style.opacity = '0';
    setTimeout(() => el.remove(), 1000);
  });
  
  // Fade out name prompt
  const namePrompt = document.getElementById('namePrompt');
  namePrompt.style.transition = 'opacity 1s ease';
  namePrompt.style.opacity = '0';
  
  // Start the fast halo transition (4 seconds)
  setTimeout(() => {
    // Remove name prompt completely
    namePrompt.style.display = 'none';
    
    // Show main content wrapper
    document.getElementById('mainContent').style.display = 'block';
    
    // Display the thank you note with customer name
    displayThankYouNoteWithName();
    
    // Start the transition halo with welcome note
    startTransitionHaloWithWelcome();
  }, 1000);
}

// 4-SECOND TRANSITION HALO WITH WELCOME NOTE
function startTransitionHaloWithWelcome() {
  const container = document.querySelector('.container');
  const rect = container.getBoundingClientRect();
  const centerX = rect.left + rect.width / 2.1;
  const centerY = rect.top + rect.height / 1.2;
  const haloRadius = 120;
  const haloCount = 25;
  const haloDuration = 4000;
  
  let transitionHaloElements = [];
  for(let i = 0; i < haloCount; i++) {
    const s = document.createElement('div');
    s.className = 'sparkle';
    s.innerText = cometChars[Math.floor(Math.random() * cometChars.length)];
    s.style.fontSize = (6 + Math.random() * 8) + 'px';
    s.style.opacity = '0';
    document.body.appendChild(s);
    transitionHaloElements.push(s);
  }
  
  // Show welcome note
  displayWelcomeNote();
  
  let startTime = null;
  
  function animateTransitionHalo(timestamp) {
    if (!startTime) startTime = timestamp;
    const elapsed = timestamp - startTime;
    const angleOffset = (elapsed / haloDuration) * 1 * Math.PI;
    
    transitionHaloElements.forEach((s, i) => {
      const angle = (i / haloCount) * 2 * Math.PI + angleOffset;
      s.style.left = (centerX + haloRadius * Math.cos(angle) * 1.2) + 'px';
      s.style.top = (centerY + haloRadius * Math.sin(angle) * 0.8) + 'px';
      s.style.opacity = 0.8 + 0.2 * Math.sin(angle * 5 + elapsed / 200);
    });
    
    if (elapsed < haloDuration) {
      requestAnimationFrame(animateTransitionHalo);
    } else {
      // Play chime sound when halo fades to main page
      playChimeSound();
      
      // Fade out welcome note along with halo
      const welcomeContainer = document.getElementById('welcomeNoteContainer');
      welcomeContainer.style.transition = 'opacity 1s ease';
      welcomeContainer.style.opacity = '0';
      
      // Fade out transition halo
      transitionHaloElements.forEach(s => {
        s.style.transition = 'opacity 1s ease';
        s.style.opacity = '0';
        setTimeout(() => s.remove(), 1000);
      });
      
      // Show main content with customer name
      setTimeout(() => {
        document.querySelector('.container').style.opacity = '1';
        
        startStaticTwinkle();
        startFlowerAnimations();
        
        // Remove welcome note completely
        setTimeout(() => {
          welcomeContainer.style.display = 'none';
        }, 1000);
      }, 1000);
    }
  }
  
  requestAnimationFrame(animateTransitionHalo);
}

// HANDLE NAME SUBMISSION
document.getElementById('submitName').addEventListener('click', function() {
  const nameInput = document.getElementById('customerName');
  const name = nameInput.value.trim();
  
  if (name) {
    customerName = name;
    transitionToMainContent();
  } else {
    nameInput.style.transform = 'translateX(5px)';
    setTimeout(() => {
      nameInput.style.transform = 'translateX(-5px)';
      setTimeout(() => {
        nameInput.style.transform = 'translateX(0)';
      }, 100);
    }, 100);
  }
});

// ALLOW ENTER KEY TO SUBMIT NAME
document.getElementById('customerName').addEventListener('keypress', function(e) {
  if (e.key === 'Enter') {
    document.getElementById('submitName').click();
  }
});

// AUTO-FOCUS ON NAME INPUT WHEN PAGE LOADS
window.addEventListener('load', function() {
  // Randomly select notes on page load
  selectedThankYouNote = thankYouNotes[Math.floor(Math.random() * thankYouNotes.length)];
  selectedWelcomeNote = welcomeNotes[Math.floor(Math.random() * welcomeNotes.length)];
  
  document.getElementById('customerName').focus();
  createNamePromptHalo();
});

// REMAINING ORIGINAL FUNCTIONS
let sparkleSets = [[], [], []];
const setCount = 3;
const sparklesPerSet = 22;

function startStaticTwinkle() {
  for (let set = 0; set < setCount; set++) {
    for (let i = 0; i < sparklesPerSet; i++) {
      const s = document.createElement('div');
      s.className = 'sparkle';
      s.innerText = cometChars[Math.floor(Math.random() * cometChars.length)];
      s.style.left = Math.random() * 100 + 'vw';
      s.style.top = Math.random() * 100 + 'vh';
      s.style.fontSize = (0.08 + Math.random() * 8) + 'px';
      s.style.transition = 'opacity 2s ease-in-out';
      document.body.appendChild(s);
      sparkleSets[set].push(s);
    }
  }

  let activeSet = 0;
  setInterval(() => {
    for (let i = 0; i < setCount; i++) {
      sparkleSets[i].forEach(s => {
        s.style.opacity = (i === activeSet ? 1 : 0);
      });
    }
    activeSet = (activeSet + 1) % setCount;
  }, 2500);
}

const bloomFrames = ["1.png","2.png","3.png","4.png","5.png","6.png","7.png"];

// Preload bloom frames
const loadedFrames = [];
bloomFrames.forEach(src => {
  const img = new Image();
  img.src = src;
  loadedFrames.push(img);
});

function animateFlower(flower) {
  const flowerWrap = flower.parentElement;
  let scale = 1;

  if (flowerWrap.classList.contains('size-small')) scale = 0.9;
  else if (flowerWrap.classList.contains('size-medium')) scale = 1;
  else scale = 1.15;

  let frame = 0;
  let direction = 1;

  const frameCount = bloomFrames.length;
  const delay = 250;
  let lastTime = null;

  function next(timestamp) {
    if (!lastTime) lastTime = timestamp;
    const elapsed = timestamp - lastTime;

    if (elapsed >= delay) {
      flower.style.backgroundImage = `url(${bloomFrames[frame]})`;

      let rotation = 0;
      if (frame === frameCount - 1) rotation = 25;
      else if (frame === frameCount - 2) rotation = 12;

      flower.style.transform = `scale(${scale}) rotate(${rotation}deg)`;

      frame += direction;
      if (frame >= frameCount - 1 || frame <= 0) direction *= -1;

      lastTime = timestamp;
    }

    requestAnimationFrame(next);
  }

  requestAnimationFrame(next);
}

function startFlowerAnimations() {
  document.querySelectorAll(".flower").forEach(f => animateFlower(f));
}
</script>
</body>
</html>